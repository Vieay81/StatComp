---
title: "A-20020-2020-09-29"
output: html_document
---
## Question
Exercises 3.3, 3.9, 3.10, and 3.13 (pages 94-95, Statistical Computating with R).  

## Answer
#### Exercise 3.3  
**Solution:** First, derive the inverse of cdf $F(x)$ of Pareto($a$,$b$). 
\begin{align*}
& y=F(x)=1-\left(\frac{b}{x}\right)^a,\quad x\ge b>0,a>0 \\
& \Rightarrow \left(\frac{b}{x}\right)^a=1-y \\
& \Rightarrow x=b(1-y)^{-1/a} \\
& \Rightarrow F^{-1}(y)=b(1-y)^{-1/a},\quad 0\leq y\leq 1
\end{align*}
The algorithm steps for inverse transform method are as follows: $(a=2,b=2)$  
**Step1:** Generate $u_i∼U[0,1],\,i=1,2,..,n$;  
**Step2:** Return $X_i:=F^{-1}(u_i)=,2(1-u_i)^{-1/2},\,i=1,2,..,n$.
```{r}
set.seed(1)
a <- 2
b <- 2
n <- 1000
u <- runif(n)
x <- 2*(1-u)^(-1/2)
hist(x, prob = TRUE, main = expression(f(x)==8*x^{-3}))
y <- seq(2, 100, .01)
lines(y, 8*y^(-3))
```
  
#### Exercise 3.9
**Solution:** The algorithm steps are as follows:  
**Step1:** At the $kth$ loop, generate i.i.d. $u_{k1},u_{k2},u_{k3}∼U(-1,1)$;  
**Step2:** If $|u_{k3}|\ge|u_{k2}|$ and $|u_{k3}|\ge|u_{k1}|$, return $X_k:=u_{k2}$; otherwise return $X_k:=u_{k3}$;  
**Step3:** Terminate the algorithm if $k=n$, or $k:=k+1$ and return **Step1**.
```{r}
set.seed(2)
n <- 10000
u <- matrix(runif(3*n,-1,1), nrow = n)
x <- numeric(n)
L <- apply(abs(u),1,which.max) == 3
coord <- 3-L
for (i in 1:n)
{
  x[i] <- u[i,coord[i]]
}
hist(x, prob = TRUE, main = expression(f[e](x)==frac(3,4)*(1-x^2)))
y <- seq(-1, 1, .01)
lines(y, (3/4)*(1-y^2))
```

#### Exercise 3.10
**Proof:** Let $X$ be the variate generated by the algorithm in Exercise 3.19, then derive the cdf of $X$, $F(x)$.  
\begin{align*}
F(x) & =P(X\leq x) \\
& =P(U_2\leq x,|U_3|\ge|U_2|,|U_3|\ge|U_1|)+P(U_3\leq x,otherwise) \\
& =P(U_2\leq x,|U_3|\ge|U_2|,|U_3|\ge|U_1|)+P(U_3\leq x,(|U_3|<|U_2|)\cup(|U_3|<|U_1|)) \\
& =P(U_2\leq x,|U_3|\ge|U_2|,|U_3|\ge|U_1|)+P(U_3\leq x,|U_3|<|U_2|) \\
& +P(U_3\leq x,|U_3|<|U_1|)-P(U_3\leq x,|U_3|<|U_1|,|U_3|<|U_2|) \\
& +\frac{1}{8}\left[\int_{-1}^x\left(\left(\int_{-1}^{-|u_2|}+\int_{|u_2|}^1\right)\left(\int_{-|u_3|}^{|u_3|}\,du_1\right)\,du_3\right)\,du_2+2\int_{-1}^x\left(\left(\int_{-1}^{-|u_3|}+\int_{|u_3|}^1\right)\,du_2\right)\,du_3
-\int_{-1}^x\left(\left(\int_{-1}^{-|u_3|}+\int_{|u_3|}^1\right)\,du_1\right)^2\,du_3\right] \\
& =-\frac{1}{4}x^3+\frac{3}{4}x+\frac{1}{2}
\end{align*}
Therefore, the pdf of $X$ is 
\[
f(x)=\partial F(x)/\partial x=-\frac{3}{4}x^2+\frac{3}{4}=f_e(x),
\]
that is, the algorithm given in Exercise 3.9 generates variates from the density $f_e$.  

#### Exercise 3.13
**Solution:** Use the inverse transform method. First, derive the inverse of cdf $F(x)$ of the mixture with $r$ and $\beta$. 
\begin{align*}
& x=F(y)=1-\left(\frac{\beta}{\beta+y}\right)^r,\quad y\ge 0 \\
& \Rightarrow \left(\frac{\beta}{\beta+y}\right)^r=1-x \\
& \Rightarrow \frac{\beta}{\beta+y}=(1-x)^{1/r} \\
& \Rightarrow y=\beta(1-x)^{-1/r}-\beta \\
& \Rightarrow F^{-1}(x)=\beta(1-x)^{-1/r}-\beta,\quad 0\leq x\leq 1
\end{align*}
The algorithm steps for inverse transform method are as follows: $(r=4,\beta=2,n=1000)$  
**Step1:** Generate $u_i∼U[0,1],\,i=1,2,..,n$;  
**Step2:** Return $X_i:=F^{-1}(u_i)=2(1-u_i)^{-1/4}-2,\,i=1,2,..,n$.
```{r}
set.seed(4)
r <- 4
beta <- 2
n <- 1000
u <- runif(n)
y <- beta*(1-u)^(-1/r) - beta
hist(y, prob = TRUE, main = expression(f(y)==frac(64,(2+y)^5)))
x <- seq(0, 10, .01)
lines(x, 64/((2+x)^5))
```